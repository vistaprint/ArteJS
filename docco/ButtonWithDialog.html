<!DOCTYPE html>

<html>
<head>
  <title>ButtonWithDialog.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="Arte.html">
                Arte.js
              </a>
            
              
              <a class="source" href="Commands.html">
                Commands.js
              </a>
            
              
              <a class="source" href="Configuration.html">
                Configuration.js
              </a>
            
              
              <a class="source" href="PluginManager.html">
                PluginManager.js
              </a>
            
              
              <a class="source" href="TextArea.html">
                TextArea.js
              </a>
            
              
              <a class="source" href="Util.html">
                Util.js
              </a>
            
              
              <a class="source" href="jquery-dom-cleanup.html">
                jquery-dom-cleanup.js
              </a>
            
              
              <a class="source" href="jquery-dom-manipulation.html">
                jquery-dom-manipulation.js
              </a>
            
              
              <a class="source" href="jquery-dom-traversal.html">
                jquery-dom-traversal.js
              </a>
            
              
              <a class="source" href="rangy-blockElementApplier.html">
                rangy-blockElementApplier.js
              </a>
            
              
              <a class="source" href="rangy-elementApplierOptions.html">
                rangy-elementApplierOptions.js
              </a>
            
              
              <a class="source" href="rangy-extensions.html">
                rangy-extensions.js
              </a>
            
              
              <a class="source" href="rangy-inlineElementApplier.html">
                rangy-inlineElementApplier.js
              </a>
            
              
              <a class="source" href="richtextCommandApplier.html">
                richtextCommandApplier.js
              </a>
            
              
              <a class="source" href="InsertCommand.html">
                InsertCommand.js
              </a>
            
              
              <a class="source" href="StateDetector.html">
                StateDetector.js
              </a>
            
              
              <a class="source" href="UndoManager.html">
                UndoManager.js
              </a>
            
              
              <a class="source" href="keyboardEventHandler.html">
                keyboardEventHandler.js
              </a>
            
              
              <a class="source" href="pasteHandler.html">
                pasteHandler.js
              </a>
            
              
              <a class="source" href="Button.html">
                Button.js
              </a>
            
              
              <a class="source" href="ButtonWithDialog.html">
                ButtonWithDialog.js
              </a>
            
              
              <a class="source" href="ButtonWithDropDown.html">
                ButtonWithDropDown.js
              </a>
            
              
              <a class="source" href="Configuration.html">
                Configuration.js
              </a>
            
              
              <a class="source" href="SelectionManager.html">
                SelectionManager.js
              </a>
            
              
              <a class="source" href="toolbar.html">
                toolbar.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>ButtonWithDialog.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>ï»¿(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($)</span> </span>{
    $.Arte.Toolbar.ButtonWithDialog = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(toolbar, buttonName, config)</span> </span>{
        <span class="hljs-keyword">var</span> me = <span class="hljs-keyword">this</span>;
        $.Arte.Toolbar.Button.call(<span class="hljs-keyword">this</span>, toolbar, buttonName, config);

        <span class="hljs-keyword">var</span> dialogClasses = $.Arte.Toolbar.configuration.classes.dialog;

        <span class="hljs-keyword">this</span>.executeCommand = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (me.isEnabled()) {
                me.showPopup();
            }
        };

        <span class="hljs-keyword">this</span>.getOkCancelControl = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> wrapper = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(dialogClasses.okCancel);
            $(<span class="hljs-string">"&lt;a&gt;"</span>).attr(<span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span>).addClass(dialogClasses.button + <span class="hljs-string">" ok"</span>).html(<span class="hljs-string">"&amp;#x2713"</span>).appendTo(wrapper);
            $(<span class="hljs-string">"&lt;a&gt;"</span>).attr(<span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span>).addClass(dialogClasses.button + <span class="hljs-string">" cancel"</span>).html(<span class="hljs-string">"&amp;#x2717"</span>).appendTo(wrapper);
            <span class="hljs-keyword">return</span> wrapper;
        };

        <span class="hljs-keyword">this</span>.showPopup = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> dialogContainer = $(<span class="hljs-string">"."</span> + dialogClasses.container);
            <span class="hljs-keyword">var</span> contentWrapper = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(dialogClasses.contentWrapper).appendTo(dialogContainer);
            contentWrapper.append(me.getDialogContent());
            contentWrapper.append(me.getOkCancelControl());
            dialogContainer.on(<span class="hljs-string">"mousedown "</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
                e.stopPropagation();
            });
            <span class="hljs-keyword">var</span> savedSelection = rangy.saveSelection();

            me.addContent();

            contentWrapper.find(<span class="hljs-string">".ok"</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                rangy.restoreSelection(savedSelection);
                me.onOk();
                me.closePopup();
            });

            contentWrapper.find(<span class="hljs-string">".cancel"</span>).on(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                rangy.restoreSelection(savedSelection);
                me.closePopup();
            });

            dialogContainer.show({
                duration: <span class="hljs-number">200</span>,
                complete: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    contentWrapper.css(<span class="hljs-string">"margin-top"</span>, -<span class="hljs-number">1</span> * contentWrapper.height() / <span class="hljs-number">2</span>);
                }
            });
        };

        <span class="hljs-keyword">this</span>.closePopup = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> dialogContainer = $(<span class="hljs-string">"."</span> + dialogClasses.container);
            dialogContainer.children().each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.remove();
            });
            dialogContainer.hide();
        };
        <span class="hljs-keyword">return</span> me;
    };
})(jQuery);

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    $.Arte.Toolbar.InsertLink = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(toolbar, buttonName, config)</span> </span>{
        <span class="hljs-keyword">var</span> dialogClasses = $.Arte.Toolbar.configuration.classes.dialog;
        <span class="hljs-keyword">var</span> insertLinkClasses = dialogClasses.insertLink;

        $.Arte.Toolbar.ButtonWithDialog.call(<span class="hljs-keyword">this</span>, toolbar, buttonName, config);

        <span class="hljs-keyword">var</span> insertContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(contentToInsert)</span> </span>{
            $.each(toolbar.selectionManager.getSelectedEditors(), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.insert.call(<span class="hljs-keyword">this</span>, {
                    commandValue: contentToInsert
                });
            });
        };

        <span class="hljs-keyword">this</span>.getDialogContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> textToShow = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(dialogClasses.insertLink.textToShow);
            $(<span class="hljs-string">"&lt;span&gt;"</span>).html(<span class="hljs-string">"Text to Show: "</span>).addClass(dialogClasses.label).appendTo(textToShow);
            $(<span class="hljs-string">"&lt;input&gt;"</span>).addClass(insertLinkClasses.input + <span class="hljs-string">" textToShow"</span>).attr({
                type: <span class="hljs-string">"text"</span>
            }).appendTo(textToShow);

            <span class="hljs-keyword">var</span> urlInput = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(dialogClasses.insertLink.urlInput);
            $(<span class="hljs-string">"&lt;span&gt;"</span>).html(<span class="hljs-string">"Url: "</span>).addClass(dialogClasses.label).appendTo(urlInput);
            $(<span class="hljs-string">"&lt;input&gt;"</span>).addClass(insertLinkClasses.input + <span class="hljs-string">" url"</span>).attr({
                type: <span class="hljs-string">"text"</span>
            }).appendTo(urlInput);

            <span class="hljs-keyword">var</span> dialogContent = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(dialogClasses.content).append(textToShow).append(urlInput);
            <span class="hljs-keyword">return</span> dialogContent;
        };

        <span class="hljs-keyword">this</span>.onOk = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> textToShow = $(<span class="hljs-string">"."</span> + dialogClasses.container + <span class="hljs-string">" ."</span> + dialogClasses.insertLink.textToShow + <span class="hljs-string">" input"</span>).val();
            <span class="hljs-keyword">var</span> url = $(<span class="hljs-string">"."</span> + dialogClasses.container + <span class="hljs-string">" ."</span> + dialogClasses.insertLink.urlInput + <span class="hljs-string">" input"</span>).val();
            <span class="hljs-keyword">if</span> (url) {
                <span class="hljs-keyword">var</span> html = $(<span class="hljs-string">"&lt;a&gt;"</span>).attr(<span class="hljs-string">"href"</span>, url).html(textToShow || url);
                insertContent(html.get(<span class="hljs-number">0</span>).outerHTML);
            }
        };

        <span class="hljs-keyword">this</span>.addContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            $(<span class="hljs-string">"."</span> + dialogClasses.container + <span class="hljs-string">" .textToShow"</span>).val(rangy.getSelection().toHtml());
        };

    };
})(jQuery);

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    $.Arte.Toolbar.InsertImage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(toolbar, buttonName, config)</span> </span>{
        <span class="hljs-keyword">var</span> dialogClasses = $.Arte.Toolbar.configuration.classes.dialog;
        <span class="hljs-keyword">var</span> insertLinkClasses = dialogClasses.insertLink;
        $.Arte.Toolbar.ButtonWithDialog.call(<span class="hljs-keyword">this</span>, toolbar, buttonName, config);

        <span class="hljs-keyword">var</span> insertContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(contentToInsert)</span> </span>{
            $.each(toolbar.selectionManager.getSelectedEditors(), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.insert.call(<span class="hljs-keyword">this</span>, {
                    commandValue: contentToInsert
                });
            });
        };

        <span class="hljs-keyword">this</span>.getDialogContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> dialogContent = $(<span class="hljs-string">"&lt;div&gt;"</span>).addClass(<span class="hljs-string">"input-prepend input-append"</span>);
            $(<span class="hljs-string">"&lt;span&gt;"</span>).html(<span class="hljs-string">"Text to Show: "</span>).addClass(insertLinkClasses.label).appendTo(dialogContent);
            $(<span class="hljs-string">"&lt;input&gt;"</span>).addClass(insertLinkClasses.input + <span class="hljs-string">" textToShow"</span>).attr({
                type: <span class="hljs-string">"text"</span>
            }).appendTo(dialogContent).css({
                height: <span class="hljs-string">"auto"</span>
            });
            $(<span class="hljs-string">"&lt;span&gt;"</span>).html(<span class="hljs-string">"Url: "</span>).addClass(insertLinkClasses.label).appendTo(dialogContent);
            $(<span class="hljs-string">"&lt;input&gt;"</span>).addClass(insertLinkClasses.input + <span class="hljs-string">" url"</span>).attr({
                type: <span class="hljs-string">"text"</span>
            }).appendTo(dialogContent).css({
                height: <span class="hljs-string">"auto"</span>
            });
            <span class="hljs-keyword">return</span> dialogContent;
        };

        <span class="hljs-keyword">this</span>.onOk = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> contentToInsert = $(<span class="hljs-string">"."</span> + dialogClasses.container + <span class="hljs-string">" .url"</span>).val();
            <span class="hljs-keyword">if</span> (contentToInsert) {
                <span class="hljs-keyword">var</span> html = $(<span class="hljs-string">"&lt;img&gt;"</span>).attr(<span class="hljs-string">"src"</span>, contentToInsert);
                insertContent(html.get(<span class="hljs-number">0</span>).outerHTML);
            }
        };

        <span class="hljs-keyword">this</span>.addContent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            $(<span class="hljs-string">"."</span> + dialogClasses.container + <span class="hljs-string">" .textToShow"</span>).val(rangy.getSelection().toHtml());
        };
    };
})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
