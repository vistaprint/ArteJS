<!DOCTYPE html>

<html>
<head>
  <title>Button.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="Arte.html">
                Arte.js
              </a>
            
              
              <a class="source" href="Commands.html">
                Commands.js
              </a>
            
              
              <a class="source" href="Configuration.html">
                Configuration.js
              </a>
            
              
              <a class="source" href="PluginManager.html">
                PluginManager.js
              </a>
            
              
              <a class="source" href="TextArea.html">
                TextArea.js
              </a>
            
              
              <a class="source" href="Util.html">
                Util.js
              </a>
            
              
              <a class="source" href="jquery-dom-cleanup.html">
                jquery-dom-cleanup.js
              </a>
            
              
              <a class="source" href="jquery-dom-manipulation.html">
                jquery-dom-manipulation.js
              </a>
            
              
              <a class="source" href="jquery-dom-traversal.html">
                jquery-dom-traversal.js
              </a>
            
              
              <a class="source" href="rangy-blockElementApplier.html">
                rangy-blockElementApplier.js
              </a>
            
              
              <a class="source" href="rangy-elementApplierOptions.html">
                rangy-elementApplierOptions.js
              </a>
            
              
              <a class="source" href="rangy-extensions.html">
                rangy-extensions.js
              </a>
            
              
              <a class="source" href="rangy-inlineElementApplier.html">
                rangy-inlineElementApplier.js
              </a>
            
              
              <a class="source" href="richtextCommandApplier.html">
                richtextCommandApplier.js
              </a>
            
              
              <a class="source" href="InsertCommand.html">
                InsertCommand.js
              </a>
            
              
              <a class="source" href="StateDetector.html">
                StateDetector.js
              </a>
            
              
              <a class="source" href="UndoManager.html">
                UndoManager.js
              </a>
            
              
              <a class="source" href="keyboardEventHandler.html">
                keyboardEventHandler.js
              </a>
            
              
              <a class="source" href="pasteHandler.html">
                pasteHandler.js
              </a>
            
              
              <a class="source" href="Button.html">
                Button.js
              </a>
            
              
              <a class="source" href="ButtonWithDialog.html">
                ButtonWithDialog.js
              </a>
            
              
              <a class="source" href="ButtonWithDropDown.html">
                ButtonWithDropDown.js
              </a>
            
              
              <a class="source" href="Configuration.html">
                Configuration.js
              </a>
            
              
              <a class="source" href="SelectionManager.html">
                SelectionManager.js
              </a>
            
              
              <a class="source" href="toolbar.html">
                toolbar.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Button.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>/ dependencies: Toolbar</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($)</span> </span>{
    $.Arte.Toolbar.Button = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(toolbar, buttonName, config)</span> </span>{
        <span class="hljs-keyword">var</span> me = <span class="hljs-keyword">this</span>;
        me.element = <span class="hljs-literal">null</span>;
        me.commandName = config.commandName;
        <span class="hljs-keyword">var</span> configuration = $.Arte.Toolbar.configuration;
        <span class="hljs-keyword">var</span> classes = configuration.classes;
        <span class="hljs-keyword">var</span> buttonClasses = classes.button;

        <span class="hljs-keyword">this</span>.isApplicable = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> editors = toolbar.selectionManager.getEditors(config.supportedTypes);
            <span class="hljs-keyword">return</span> editors &amp;&amp; editors.length;
        };

        <span class="hljs-keyword">this</span>.isEnabled = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!configuration.requireEditorFocus) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }

            <span class="hljs-keyword">var</span> selectedEditors = toolbar.selectionManager.getSelectedEditors(config.supportedTypes);
            <span class="hljs-keyword">return</span> (selectedEditors &amp;&amp; selectedEditors.length);
        };

        <span class="hljs-keyword">this</span>.executeCommand = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(commandValue)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEnabled()) {
                <span class="hljs-keyword">var</span> commandAttrType = (config &amp;&amp; config.commandAttrType) ?
                    config.commandAttrType :
                    $.Arte.Toolbar.configuration.commandAttrType;

                <span class="hljs-keyword">var</span> value = commandValue || (config.commandValue ? config.commandValue[commandAttrType] : <span class="hljs-string">""</span>);

                <span class="hljs-keyword">if</span> (!value &amp;&amp; !config.supportsTagName &amp;&amp; config.commandValue) {
                    commandAttrType = $.Arte.Toolbar.configuration.altCommandAttrType;
                    value = config.commandValue[commandAttrType];
                }

                <span class="hljs-keyword">var</span> commandOptions = {
                    commandName: config.commandName,
                    commandValue: value,
                    commandAttrType: commandAttrType
                };

                <span class="hljs-keyword">var</span> selectedEditors = toolbar.selectionManager.getSelectedEditors();
                <span class="hljs-keyword">if</span> (!selectedEditors.length &amp;&amp; !configuration.requireEditorFocus) {
                    selectedEditors = toolbar.selectionManager.getEditors();
                }

                $.each(selectedEditors, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">this</span>[commandOptions.commandName].call(<span class="hljs-keyword">this</span>, commandOptions);
                });
                toolbar.refresh();
            }
        };

        <span class="hljs-keyword">this</span>.render = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> inner = $(<span class="hljs-string">"&lt;span&gt;"</span>).addClass(buttonName).addClass(buttonClasses.inner);
            me.$el = $(<span class="hljs-string">"&lt;a&gt;"</span>).attr(<span class="hljs-string">"href"</span>, <span class="hljs-string">"#"</span>).addClass(buttonClasses.outer).html(inner);
            me.$el.on({
                mouseover: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
                    me.showTooltip(e);
                },
                mouseout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
                    me.hideTooltip(e);
                },
                mousedown: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
                    e.preventDefault();
                    e.stopPropagation();
                },
                click: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
                    me.executeCommand.apply(me);
                    e.preventDefault();
                    e.stopPropagation();
                }
            });

            me.$el.appendTo(toolbar.$el);
        };

        <span class="hljs-keyword">this</span>.unrender = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            me.$el.off();
            me.$el.remove();
        };

        <span class="hljs-keyword">var</span> isApplied = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(state)</span> </span>{
            <span class="hljs-keyword">if</span> (config.commandName === <span class="hljs-string">"textAlign"</span>) {
                <span class="hljs-keyword">var</span> defaultValue = config.commandValue[$.Arte.Toolbar.configuration.commandAttrType] ||
                    config.commandValue[$.Arte.Toolbar.configuration.altCommandAttrType];
                <span class="hljs-keyword">return</span> state === defaultValue;
            }
            <span class="hljs-keyword">return</span> state;
        };

        <span class="hljs-keyword">this</span>.refresh = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(state)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isApplicable()) {
                <span class="hljs-keyword">this</span>.$el.show();
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.$el.hide();
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEnabled()) {
                me.$el.removeClass(buttonClasses.disabled);

                <span class="hljs-keyword">var</span> op = isApplied(state[config.commandName]) ? <span class="hljs-string">"addClass"</span> : <span class="hljs-string">"removeClass"</span>;
                me.$el[op](buttonClasses.selected);
            } <span class="hljs-keyword">else</span> {
                me.$el.addClass(buttonClasses.disabled);
                me.$el.removeClass(buttonClasses.selected);
            }
        };

        <span class="hljs-keyword">this</span>.showTooltip = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(mouseEvent)</span> </span>{
            <span class="hljs-keyword">if</span> (me.$el.hasClass(buttonClasses.disabled)) {
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">var</span> tooltip = toolbar.$el.find(<span class="hljs-string">"."</span> + classes.tooltip.container);
            tooltip.html(config.tooltip || <span class="hljs-keyword">this</span>.commandName);</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>position the tooltip</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> elementOffset = toolbar.$el.offset();
            <span class="hljs-keyword">var</span> x = mouseEvent.pageX - elementOffset.left + <span class="hljs-number">15</span>;
            <span class="hljs-keyword">var</span> y = mouseEvent.pageY - elementOffset.top + <span class="hljs-number">5</span>;

            tooltip.css({
                top: y,
                left: x
            });
            tooltip.show();
        };
        <span class="hljs-keyword">this</span>.hideTooltip = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (me.$el.hasClass(buttonClasses.disabled)) {
                <span class="hljs-keyword">return</span>;
            }

            toolbar.$el.find(<span class="hljs-string">"."</span> + classes.tooltip.container).hide();
        };
    };
})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
